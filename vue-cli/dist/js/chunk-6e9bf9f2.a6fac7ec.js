(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e9bf9f2"],{"0a0c":function(e,t,a){},1:function(e,t){},"304b":function(e,t,a){},"6a24":function(e,t,a){},a1ab:function(e,t,a){"use strict";var i=a("0a0c"),r=a.n(i);r.a},a961:function(e,t,a){},bb44:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("ReviewForm",{attrs:{scenarioId:e.scenarioId,newId:e.newId,oldId:e.oldId,panelHeight:e.panelHeight},on:{scenarioName:e.setBreadcrumbs,calcHeight:e.calcHeight}})],1)},r=[],s=(a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("ul",{staticClass:"nav nav-tabs"},[a("li",{staticClass:"nav-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.activeTabId,expression:"activeTabId"}],attrs:{id:"tab-page",type:"radio",value:"1"},domProps:{checked:e._q(e.activeTabId,"1")},on:{change:function(t){e.activeTabId="1"}}}),a("label",{staticClass:"nav-link",class:{active:e.isActiveTab(1)},attrs:{for:"tab-page"}},[e._v("ページ")])]),a("li",{staticClass:"nav-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.activeTabId,expression:"activeTabId"}],attrs:{id:"tab-part",type:"radio",value:"2"},domProps:{checked:e._q(e.activeTabId,"2")},on:{change:function(t){e.activeTabId="2"}}}),a("label",{staticClass:"nav-link",class:{active:e.isActiveTab(2)},attrs:{for:"tab-part"}},[e._v("部分")])]),a("li",{staticClass:"nav-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.activeTabId,expression:"activeTabId"}],attrs:{id:"tab-image",type:"radio",value:"3"},domProps:{checked:e._q(e.activeTabId,"3")},on:{change:function(t){e.activeTabId="3"}}}),a("label",{staticClass:"nav-link",class:{active:e.isActiveTab(3)},attrs:{for:"tab-image"}},[e._v("画像")])]),a("li",{directives:[{name:"show",rawName:"v-show",value:!e.nocompared,expression:"!nocompared"}],staticClass:"nav-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.activeTabId,expression:"activeTabId"}],attrs:{id:"tab-history",type:"radio",value:"4"},domProps:{checked:e._q(e.activeTabId,"4")},on:{change:function(t){e.activeTabId="4"}}}),a("label",{staticClass:"nav-link",class:{active:e.isActiveTab(4)},attrs:{for:"tab-history"}},[e._v("履歴")])]),a("li",{staticClass:"nav-item ml-auto mr-0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.activeTabId,expression:"activeTabId"}],attrs:{id:"tab-edit",type:"radio",value:"5"},domProps:{checked:e._q(e.activeTabId,"5")},on:{change:function(t){e.activeTabId="5"}}}),a("label",{staticClass:"nav-link",class:{active:e.isActiveTab(5)},attrs:{for:"tab-edit"}},[e._v(e._s(e.scenarioName))])])]),a("PageDiffPanel",{directives:[{name:"show",rawName:"v-show",value:e.isActiveTab(1),expression:"isActiveTab(1)"}],style:{height:e.panelHeight},attrs:{currTarget:e.targetSchedule,prevTarget:e.previousSchedule,currTimestamp:e.targetTimestamp,prevTimestamp:e.previousTimestamp,fileName:e.pageDiffFileName,triggerDiff:e.triggerPageDiff},on:{ignite:function(t){e.triggerPageDiff=!1}}}),a("PartDiffPanel",{directives:[{name:"show",rawName:"v-show",value:e.isActiveTab(2),expression:"isActiveTab(2)"}],style:{height:e.panelHeight},attrs:{currTarget:e.targetSchedule,prevTarget:e.previousSchedule,currTimestamp:e.targetTimestamp,prevTimestamp:e.previousTimestamp,fileName:e.partDiffFileName,triggerDiff:e.triggerPartDiff},on:{ignite:function(t){e.triggerPartDiff=!1}}}),a("DiffImage",{directives:[{name:"show",rawName:"v-show",value:e.isActiveTab(3),expression:"isActiveTab(3)"}],style:{height:e.panelHeight},attrs:{currTarget:e.targetSchedule,prevTarget:e.previousSchedule,currTimestamp:e.targetTimestamp,prevTimestamp:e.previousTimestamp,fileName:e.imageDiffFileName,triggerDiff:e.triggerImageDiff},on:{ignite:function(t){e.triggerImageDiff=!1}}}),a("History",{directives:[{name:"show",rawName:"v-show",value:e.isActiveTab(4),expression:"isActiveTab(4)"}],style:{height:e.panelHeight},attrs:{scenarioId:e.scenarioId,currTarget:e.targetSchedule,prevTarget:e.previousSchedule,currTimestamp:e.targetTimestamp,prevTimestamp:e.previousTimestamp},on:{compare:e.compareHistory}}),a("ScenarioEdit",{directives:[{name:"show",rawName:"v-show",value:e.isActiveTab(5),expression:"isActiveTab(5)"}],staticClass:"p-2 border border-gray border-top-0",style:{height:e.panelHeight},attrs:{scenarioId:e.scenarioId}}),a("DiffDialog",{attrs:{showDialog:e.showDiffDialog},on:{cancel:e.closeDiffDialog,ok:e.doDiff}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"fas fa-question-circle mr-2"}),e._v("再差分生成確認")]),a("div",{attrs:{slot:"body"},slot:"body"},[e._v("差分ファイルが見つからなかったので、再作成しますか？")]),a("span",{attrs:{slot:"ok"},slot:"ok"},[a("i",{staticClass:"fas fa-check-circle mr-2"}),e._v("OK")])]),a("ErrorDialog",{attrs:{showDialog:e.showErrorDialog,classList:["border","border-danger"]}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"fas fa-exclamation-triangle mr-2"}),e._v("エラー")]),a("div",{attrs:{slot:"body"},slot:"body"},[a("ul",e._l(e.errors,function(t,i){return a("li",{key:i},[e._v(e._s(t))])}),0)]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary mr-0 ml-auto",on:{click:e.closeErrorDialog}},[a("i",{staticClass:"fas fa-check-circle mr-2"}),e._v("OK")])])])])],1)}),n=[],o=(a("96cf"),a("1da1")),c=(a("cadf"),a("551c"),a("097d"),a("1f4c")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"diff-panel p-2 border border-gray border-top-0"},[a("div",{staticClass:"d-flex",class:{adjuster:0===e.closeDiffPanelFlag}},[a("div",{directives:[{name:"show",rawName:"v-show",value:2!==e.expandIframeFlag&&null!=e.prevTarget,expression:"expandIframeFlag!==2 && prevTarget != null"}],staticClass:"w-100 mr-1"},[a("div",{staticClass:"mb-1 d-flex justify-content-start"},[a("i",{directives:[{name:"show",rawName:"v-show",value:1===e.expandIframeFlag,expression:"expandIframeFlag===1"}],staticClass:"btn fas fa-chevron-left fa-fw",on:{click:function(t){e.contractIframe()}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:0===e.expandIframeFlag,expression:"expandIframeFlag===0"}],staticClass:"btn fas fa-chevron-right fa-fw",on:{click:function(t){e.expandIframe(1)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:0!==e.closeDiffPanelFlag,expression:"closeDiffPanelFlag!==0"}],staticClass:"btn fas fa-chevron-up fa-fw",on:{click:function(t){e.openDiffPanel()}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:0===e.closeDiffPanelFlag,expression:"closeDiffPanelFlag===0"}],staticClass:"btn fas fa-chevron-down fa-fw",on:{click:function(t){e.closeDiffPanel(1)}}}),a("div",{staticClass:"ml-auto mr-0"},[a("i",{staticClass:"btn fas fa-external-link-alt mr-2",on:{click:function(t){e.openLink(e.prevIframeSource,!0)}}}),a("span",{staticClass:"old rounded px-2"},[e._v(e._s(e.prevTimestamp))])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.expandIframeFlag,expression:"expandIframeFlag!==1"}],staticClass:"w-100"},[a("div",{staticClass:"mb-1 d-flex justify-content-start"},[a("i",{directives:[{name:"show",rawName:"v-show",value:2===e.expandIframeFlag&&null!=e.prevTarget,expression:"expandIframeFlag===2 && prevTarget != null"}],staticClass:"btn fas fa-chevron-right fa-fw",on:{click:function(t){e.contractIframe()}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:0===e.expandIframeFlag&&null!=e.prevTarget,expression:"expandIframeFlag===0 && prevTarget != null"}],staticClass:"btn fas fa-chevron-left fa-fw",on:{click:function(t){e.expandIframe(2)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:0!==e.closeDiffPanelFlag&&null!=e.prevTarget,expression:"closeDiffPanelFlag!==0 && prevTarget != null"}],staticClass:"btn fas fa-chevron-up fa-fw",on:{click:function(t){e.openDiffPanel()}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:0===e.closeDiffPanelFlag&&null!=e.prevTarget,expression:"closeDiffPanelFlag===0 && prevTarget != null"}],staticClass:"btn fas fa-chevron-down fa-fw",on:{click:function(t){e.closeDiffPanel(2)}}}),a("div",{staticClass:"ml-auto mr-0"},[a("i",{staticClass:"btn fas fa-external-link-alt mr-2",on:{click:function(t){e.openLink(e.currIframeSource,!0)}}}),a("span",{staticClass:"new rounded px-2"},[e._v(e._s(e.currTimestamp))])])])])]),a("transition",{attrs:{name:"fade"}},[a("div",{staticClass:"d-flex justify-content-between h-100"},[a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:2!==e.expandIframeFlag&&null!=e.prevTarget,expression:"expandIframeFlag!==2 && prevTarget != null"}],staticClass:"w-100 mr-1"},[a("iframe",{staticClass:"w-100 h-100 border border-gray",attrs:{src:e.prevIframeSource,id:e.prevIframeId},on:{load:e.iframeLoaded}})])]),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.expandIframeFlag,expression:"expandIframeFlag!==1"}],staticClass:"w-100"},[a("iframe",{staticClass:"w-100 h-100 border border-gray",attrs:{src:e.currIframeSource,id:e.currIframeId},on:{load:e.iframeLoaded}})])])],1)]),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.closeDiffPanelFlag,expression:"closeDiffPanelFlag===0"}],staticClass:"bg-white",staticStyle:{"z-index":"10000"},domProps:{innerHTML:e._s(e.diff2htmlPanel)}})])],1)},f=[],u=(a("28a5"),a("0eda")),d=(a("057a"),a("bc3a")),m={name:"ReviewFormDiff",data:function(){return{closeDiffPanelFlag:0,expandIframeFlag:0,currIframeSource:null,prevIframeSource:null,diff2htmlPanel:null,iframeScrollX:0,iframeScrollY:0,prevIframeId:null,currIframeId:null}},props:["currTarget","prevTarget","fileName","currTimestamp","prevTimestamp","triggerDiff"],methods:{getDiffHtml:function(){var e=this,t="index.html"===this.fileName?1:2,a="".concat(this.$apiUrl,"/diff/")+"?id=".concat(this.currTarget.scenarioId)+"&after=".concat(this.currTarget.saveDir)+"&before=".concat(this.prevTarget.saveDir)+"&type=".concat(t);d.get(a).then(function(e){if(200===e.status)return e.data;throw new Error("error")}).then(function(t){var a={inputFormat:"diff",showFiles:!0,matching:"lines",outputFormat:"side-by-side"};e.diff2htmlPanel=u["Diff2Html"].getPrettyHtml(t,a)}).catch(function(t){404===t.response.status?(e.errors.push(t.response.config.url+" is not found"),e.showDialog=!0):console.error(t)})},expandIframe:function(e){switch(e){case 1:this.expandIframeFlag=1;break;case 2:this.expandIframeFlag=2;break}},contractIframe:function(){this.expandIframeFlag=0},closeDiffPanel:function(e){switch(e){case 1:this.closeDiffPanelFlag=1;break;case 2:this.closeDiffPanelFlag=2;break}},openDiffPanel:function(){this.closeDiffPanelFlag=0},openLink:function(e,t){t?window.open(e,"_blank"):location.href=e},iframeLoaded:function(e){var t=this;e.target.contentWindow.addEventListener("scroll",function(e){t.scrollSyncFrom(e.currentTarget.frameElement.id,e.target.body.scrollLeft,e.target.body.scrollTop)});var a=document.createElement("style");a.innerText="html{pointer-events: none;}",e.target.contentWindow.document.head.appendChild(a)},createIframeId:function(e,t){return null!=t&&t.saveDir?"".concat(e).concat(t.saveDir)+this.fileName.split(".")[0]:null},scrollSyncFrom:function(e,t,a){switch(e){case this.currIframeId:document.getElementById(this.prevIframeId).contentWindow.scrollTo(t,a);break;case this.prevIframeId:document.getElementById(this.currIframeId).contentWindow.scrollTo(t,a);break;default:break}}},computed:{enableDiff:function(){return null!=this.currIframeSource&&null!=this.prevIframeSource}},watch:{currTarget:function(){this.currIframeSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.currTarget.scenarioId,"/")+"".concat(this.currTarget.saveDir,"/")+"".concat(this.fileName),this.currIframeId=this.createIframeId("curr",this.currTarget)},prevTarget:function(){this.prevIframeSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.prevTarget.scenarioId,"/")+"".concat(this.prevTarget.saveDir,"/")+"".concat(this.fileName),this.prevIframeId=this.createIframeId("prev",this.prevTarget)},enableDiff:function(){this.enableDiff&&this.getDiffHtml()},triggerDiff:function(){this.triggerDiff&&(this.getDiffHtml(),this.$emit("ignite"))}}},v=m,h=(a("f32b"),a("c89e"),a("2877")),g=Object(h["a"])(v,l,f,!1,null,"43a3424e",null);g.options.__file="ReviewFormDiff.vue";var p=g.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"diff-panel p-2 border border-gray border-top-0"},[a("div",{staticClass:"d-flex"},[a("div",{directives:[{name:"show",rawName:"v-show",value:null!=e.prevImageSource,expression:"prevImageSource != null"}],staticClass:"w-100 mr-1",class:{"d-none":e.isMaximum(2)}},[a("div",{staticClass:"d-flex mb-1"},[a("i",{staticClass:"btn far fa-window-minimize fa-fw mr-1",on:{click:function(t){e.maximizeImage()}}}),a("i",{staticClass:"btn far fa-window-maximize fa-fw",class:{disable:e.isMaximum(1)},on:{click:function(t){e.maximizeImage(1)}}}),a("i",{staticClass:"btn far fa-clone fa-fw",on:{click:function(t){e.toggleFilter(1)}}}),a("div",{staticClass:"ml-auto mr-0"},[a("i",{staticClass:"btn fas fa-sync-alt fa-fw mr-2",on:{click:e.checkSource}}),a("span",{staticClass:"old rounded px-2"},[e._v(e._s(e.prevTimestamp))])])])]),a("div",{staticClass:"w-100 mr-1",class:{"d-none":e.isMaximum(1)}},[a("div",{staticClass:"d-flex mb-1"},[a("i",{directives:[{name:"show",rawName:"v-show",value:null!=e.prevImageSource,expression:"prevImageSource != null"}],staticClass:"btn far fa-window-minimize fa-fw mr-1",on:{click:function(t){e.maximizeImage()}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:null!=e.prevImageSource,expression:"prevImageSource != null"}],staticClass:"btn far fa-window-maximize fa-fw",class:{disable:e.isMaximum(2)},on:{click:function(t){e.maximizeImage(2)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:null!=e.prevImageSource,expression:"prevImageSource != null"}],staticClass:"btn far fa-clone fa-fw",on:{click:function(t){e.toggleFilter(2)}}}),a("div",{staticClass:"ml-auto mr-0"},[a("i",{directives:[{name:"show",rawName:"v-show",value:null!=e.prevImageSource,expression:"prevImageSource != null"}],staticClass:"btn fas fa-sync-alt fa-fw mr-2",on:{click:e.checkSource}}),a("span",{staticClass:"new rounded px-2"},[e._v(e._s(e.currTimestamp))])])])])]),a("div",{staticClass:"d-flex",staticStyle:{overflow:"scroll","margin-top":"1.25em"}},[a("div",{class:{"d-none":e.isMaximum(2)},staticStyle:{position:"relative"}},[a("img",{staticClass:"w-100 border",attrs:{src:e.prevImageSource}}),a("img",{staticClass:"w-100 border",class:{"d-none":!e.isFiltered(1)},staticStyle:{position:"absolute",left:"0",opacity:".75"},attrs:{src:e.diffImageSource}})]),a("div",{class:{"d-none":e.isMaximum(1)},staticStyle:{position:"relative"}},[a("img",{staticClass:"w-100 border",attrs:{src:e.currImageSource}}),a("img",{staticClass:"w-100 border",class:{"d-none":!e.isFiltered(2)},staticStyle:{position:"absolute",left:"0",opacity:".75"},attrs:{src:e.diffImageSource}})])])])},b=[],I={name:"ReviewFormImage",data:function(){return{currImageSource:null,prevImageSource:null,diffImageSource:null,activeImagePanel:0,activeFilter:0}},props:["currTarget","prevTarget","fileName","currTimestamp","prevTimestamp","triggerDiff"],methods:{maximizeImage:function(e){this.activeImagePanel=e||0},isMaximum:function(e){return this.activeImagePanel===e},toggleFilter:function(e){this.activeFilter=this.isFiltered(e)?this.activeFilter-e:this.activeFilter+e},isFiltered:function(e){return(this.activeFilter&e)===e},checkSource:function(e){var t=new Date,a=t.getFullYear(),i=("00"+(t.getMonth()+1)).slice(-2),r=("00"+t.getDate()).slice(-2),s=("00"+t.getHours()).slice(-2),n=("00"+t.getMinutes()).slice(-2),o=("00"+t.getSeconds()).slice(-2);this.diffImageSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.currTarget.scenarioId,"/")+"".concat(this.currTarget.saveDir,"/")+"diff_image_".concat(this.prevTarget.saveDir,".png?v=").concat(a).concat(i).concat(r).concat(s).concat(n).concat(o)}},computed:{enableDiff:function(){return null!=this.currImageSource&&null!=this.prevImageSource}},watch:{currTarget:function(){this.currImageSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.currTarget.scenarioId,"/")+"".concat(this.currTarget.saveDir,"/")+"".concat(this.fileName)},prevTarget:function(){this.prevImageSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.prevTarget.scenarioId,"/")+"".concat(this.prevTarget.saveDir,"/")+"".concat(this.fileName)},enableDiff:function(){this.enableDiff&&(this.diffImageSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.currTarget.scenarioId,"/")+"".concat(this.currTarget.saveDir,"/")+"diff_image_".concat(this.prevTarget.saveDir,".png"))},triggerDiff:function(){this.triggerDiff&&(this.diffImageSource="".concat(this.$dataUrl,"/scenario/")+"".concat(this.currTarget.scenarioId,"/")+"".concat(this.currTarget.saveDir,"/")+"diff_image_".concat(this.prevTarget.saveDir,".png"),this.$emit("ignite"))}}},T=I,D=(a("c8a2"),Object(h["a"])(T,w,b,!1,null,"2ac41763",null));D.options.__file="ReviewFormImage.vue";var x=D.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"p-2 border border-gray border-top-0"},[a("div",{staticClass:"badge badge-light"},[e._v("シナリオID: "+e._s(e.scenarioId))]),a("table",{staticClass:"table table-striped mt-3"},[e._m(0),e.historyList.length>0?a("tbody",e._l(e.historyList,function(t,i){return a("tr",{key:i},[a("td",[e._v(e._s(t._id))]),a("td",[a("span",{class:e.getCellClass(t._id)},[e._v(e._s(e.formatTimestamp(t.saveDir)))])]),a("td",{staticClass:"old"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.oldTarget,expression:"oldTarget"}],attrs:{type:"radio",name:"old"},domProps:{value:t._id,checked:e._q(e.oldTarget,t._id)},on:{change:function(a){e.oldTarget=t._id}}}),a("div")])]),a("td",{staticClass:"new"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newTarget,expression:"newTarget"}],attrs:{type:"radio",name:"new"},domProps:{value:t._id,checked:e._q(e.newTarget,t._id)},on:{change:function(a){e.newTarget=t._id}}}),a("div")])]),a("td",{staticClass:"text-center",staticStyle:{position:"relative",top:"-2px"}},[a("button",{staticClass:"btn btn-sm btn-danger py-0",attrs:{value:t._id},on:{click:e.openVoidDialog}},[e._v("無効化")]),a("span",[e._v(e._s(t.voided))])])])}),0):e._e()]),a("div",{staticClass:"text-right"},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.historyList.length>2,expression:"historyList.length > 2"}],staticClass:"btn btn-primary",on:{click:function(t){e.createCompare()}}},[e._v("比較する")])]),a("VoidDialog",{attrs:{showDialog:e.showVoidDialog}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"fas fa-question-circle mr-2"}),e._v("無効化")]),a("div",{attrs:{slot:"body"},slot:"body"},[e._v("このスケジュール結果を無効化しますか？")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-secondary",on:{click:e.closeVoidDialog}},[e._v("キャンセル")]),a("button",{staticClass:"btn btn-danger mr-0 ml-auto",on:{click:e.doVoid}},[a("i",{staticClass:"fas fa-ban mr-2"}),e._v("無効化")])])])]),a("ErrorDialog",{attrs:{showDialog:e.showErrorDialog}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"fas fa-exclamation-triangle mr-2"}),e._v("エラー")]),a("div",{attrs:{slot:"body"},slot:"body"},[a("ul",e._l(e.errors,function(t,i){return a("li",{key:i},[e._v(e._s(t))])}),0)]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary mr-0 ml-auto",on:{click:e.closeErrorDialog}},[a("i",{staticClass:"fas fa-check-circle mr-2"}),e._v("OK")])])])])],1)},C=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",[e._v("スケジュールID")]),a("th",[e._v("実施日時")]),a("th",{staticClass:"old"},[e._v("比較対象１")]),a("th",{staticClass:"new"},[e._v("比較対象２")]),a("th",{staticClass:"text-center"},[e._v("無効化")])])])}],y=a("bc3a"),S={name:"ReviewHistory",components:{ErrorDialog:c["a"],VoidDialog:c["a"]},data:function(){return{historyList:[],selected:null,oldTarget:null,newTarget:null,showVoidDialog:!1,showErrorDialog:!1,errors:[]}},props:["scenarioId","currTarget","prevTarget","fileName","currTimestamp","prevTimestamp"],methods:{getHistory:function(){var e=this,t="".concat(this.$apiUrl,"/history/").concat(this.scenarioId);y.get(t).then(function(e){if(200!==e.status)throw new Error("error");return e.data}).then(function(t){e.historyList=t}).catch(function(t){404===t.response.status?(e.errors.push(t.response.config.url+" is not found"),e.showDialog=!0):console.error(t)})},formatTimestamp:function(e){return"".concat(e.substr(0,4),"/").concat(e.substr(4,2),"/").concat(e.substr(6,2)," ").concat(e.substr(8,2),":").concat(e.substr(10,2),":").concat(e.substr(12,2))},createCompare:function(){this.$emit("compare",this.newTarget,this.oldTarget)},openVoidDialog:function(e){this.voidTarget=e.currentTarget.value,this.showVoidDialog=!0},closeVoidDialog:function(){this.voidTarget=null,this.showVoidDialog=!1},openErrorDialog:function(){this.showErrorDialog=!0},closeErrorDialog:function(){this.errors=[],this.showErrorDialog=!1},doVoid:function(){var e=this;console.log(this.voidTarget);var t=this.voidTarget,a="".concat(this.$apiUrl,"/schedule/void/").concat(t);y.put(a).then(function(e){if(200!==e.status)throw new Error("error");return e.data}).then(function(t){e.closeVoidDialog(),e.$lock("無効化中..."),e.getHistory()}).catch(function(t){404===t.response.status?(e.errors.push(t.response.config.url+" is not found"),e.showErrorDialog=!0):(console.error(t),e.errors.push(t.response.config.url),e.showErrorDialog=!0)}).then(function(){var t=e;setTimeout(function(){t.$unlock()},1e3)})},getCellClass:function(e){var t="";return null!=this.prevTarget&&this.prevTarget._id===e?t="old":this.currTarget._id===e&&(t="new"),t}},computed:{getPrevId:function(){return this.prevTarget?this.prevTarget._id:null},getcurrId:function(){return this.currTarget?this.currTarget._id:null}},watch:{scenarioId:function(){this.getHistory()},prevTarget:function(){this.oldTarget=this.prevTarget._id},currTarget:function(){this.newTarget=this.currTarget._id}}},k=S,F=(a("c859"),Object(h["a"])(k,_,C,!1,null,"9b54c970",null));F.options.__file="ReviewFormHistory.vue";var N=F.exports,P=a("4657"),E=a("bc3a"),$={name:"ReviewForm",components:{DiffDialog:c["a"],ErrorDialog:c["a"],PageDiffPanel:p,PartDiffPanel:p,DiffImage:x,History:N,ScenarioEdit:P["a"]},data:function(){return{activeTabId:1,targetSchedule:null,previousSchedule:null,errors:[],showDiffDialog:!1,showErrorDialog:!1,scenarioName:null,pageDiffFileName:"index.html",partDiffFileName:"parts.html",imageDiffFileName:"screenshot.png",targetTimestamp:null,previousTimestamp:null,triggerPageDiff:!1,triggerPartDiff:!1,triggerImageDiff:!1,nocompared:!1}},props:["scenarioId","newId","oldId","panelHeight"],methods:{isActiveTab:function(e){return parseInt(this.activeTabId)===e},getRecentlySchedule:function(e){var t=this,a="".concat(this.$apiUrl,"/schedules/").concat(e,"/recent");E.get(a).then(function(e){if(200!==e.status)throw new Error("正しいデータを取得できませんでした");return 1===e.data.length&&(t.activeTabId=5,t.nocompared=!0),e.data}).then(function(e){t.targetSchedule=e[0],t.targetTimestamp=t.formatDatetime(e[0].saveDir),null!=e[1]?(t.previousSchedule=e[1],t.previousTimestamp=t.formatDatetime(e[1].saveDir)):(t.previousSchedule=null,t.previousTimestamp=null)}).catch(function(e){t.errors.push(e.message),t.showErrorDialog=!0,console.error(e)})},getScenario:function(e){var t=this;if(this.scenario=null,e){var a="".concat(this.$apiUrl,"/scenario?id=").concat(e);E.get(a).then(function(e){if(200!==e.status)throw new Error("データを取得できませんでした");t.scenario=e.data,t.scenarioName=e.data.name,t.$emit("scenarioName",t.scenarioName)}).catch(function(e){return console.error(e)})}},getSchedule:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null==t){e.next=6;break}return a="".concat(this.$apiUrl,"/schedule/").concat(this.scenarioId,"/").concat(t),i=null,e.next=5,E.get(a).then(function(e){if(200!==e.status||1!==e.data.length)throw new Error("error");return e.data.pop()}).then(function(e){i=e}).catch(function(e){console.log(e)});case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getDialogMessage:function(){return"差分ファイルが見つからなかったので、再作成しますか？"},openDiffDialog:function(){this.showDiffDialog=!0},closeDiffDialog:function(){this.showDiffDialog=!1},openErrorDialog:function(){this.showErrorDialog=!0},closeErrorDialog:function(){this.showErrorDialog=!1},doDiff:function(e){var t=this;this.$lock("再差分作成中...");var a={scenarioId:this.scenarioId,oldId:this.previousSchedule.saveDir,newId:this.targetSchedule.saveDir},i="".concat(this.$apiUrl,"/diff");E.post(i,a).then(function(e){if(200!==e.status)throw new Error("error");t.showDiffDialog=!1}).catch(function(e){return console.error(e)}).then(function(){var e=t;setTimeout(function(){e.$unlock()},2e3)})},formatDatetime:function(e){return e?e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(8,10)+":"+e.substring(10,12)+":"+e.substring(12,14):null},openLink:function(e,t){t?window.open(e,"_blank"):location.href=e},compareHistory:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,a){var i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t,a),e.next=3,this.getSchedule(t).then(function(e){i.targetSchedule=e,i.targetTimestamp=i.formatDatetime(e.saveDir)});case 3:return e.next=5,this.getSchedule(a).then(function(e){i.previousSchedule=e,i.previousTimestamp=i.formatDatetime(e.saveDir)});case 5:return e.next=7,this.doDiff();case 7:this.triggerPageDiff=!0,this.triggerPartDiff=!0,this.triggerImageDiff=!0;case 10:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}()},watch:{scenarioId:function(){this.getRecentlySchedule(this.scenarioId),this.getScenario(this.scenarioId)}},updated:function(){this.$emit("calcHeight")}},H=$,R=(a("a1ab"),Object(h["a"])(H,s,n,!1,null,"85d68772",null));R.options.__file="ReviewForm.vue";var L=R.exports,A={name:"ViewReview",data:function(){return{scenarioId:null,newId:null,oldId:null,panelHeight:100}},components:{ReviewForm:L},methods:{calcHeight:function(){if(document.getElementsByTagName("header")&&document.getElementsByTagName("header").length>0){var e=parseInt(window.getComputedStyle(document.getElementsByTagName("header")[0]).marginBottom),t=document.getElementsByTagName("header")[0].offsetHeight,a=document.getElementsByClassName("nav")[0].offsetHeight,i=parseInt(window.getComputedStyle(document.getElementsByTagName("body")[0]).fontSize),r=window.innerHeight-t-e-a-i;this.panelHeight=r+"px",document.getElementsByClassName("diff-panel")[0].style.height=r+"px"}},setBreadcrumbs:function(e){var t=this.$router.options.routes[0];this.$emit("breadcrumbs",[{text:t.name,href:t.path},{text:e,href:this.$router.history.current.path}])}},mounted:function(){this.scenarioId=this.$route.params.id,this.newId=this.$route.params.newid,this.oldId=this.$route.params.oldid}},U=A,V=Object(h["a"])(U,i,r,!1,null,null,null);V.options.__file="Review.vue";t["default"]=V.exports},c859:function(e,t,a){"use strict";var i=a("6a24"),r=a.n(i);r.a},c89e:function(e,t,a){"use strict";var i=a("d1ae"),r=a.n(i);r.a},c8a2:function(e,t,a){"use strict";var i=a("304b"),r=a.n(i);r.a},d1ae:function(e,t,a){},f32b:function(e,t,a){"use strict";var i=a("a961"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-6e9bf9f2.a6fac7ec.js.map